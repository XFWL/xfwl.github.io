import{d as W,G as X,i as c,O as y,$ as U,r as s,K as Y,o as _,c as x,h as t,w as o,y as f,g as w,u as g,S as h,x as N,a as T,Q as Z,R as V,z as I,N as u,_ as ee}from"./index-294af10a.js";const ae=["src"],te={style:{"margin-left":"12px"}},le=["src"],oe=W({__name:"index",setup(re){X(()=>{m()});function z(a){a.target.classList.add("add_border")}const i=c({page:1,total:0,limit:3});function $(){i.value.page=1,m()}function L(){m()}const k=c();function m(){y(()=>U.product.trademark.reqTradenarkList(i.value.page,i.value.limit),a=>{i.value.total=a.data.total,k.value=a.data.records})}const d=c(!1);function O(a){n.value={tmName:"",logoUrl:""},a==null||a.clearValidate(),d.value=!0}function P(a,e){n.value={tmName:"",logoUrl:""},e==null||e.clearValidate(),n.value={id:a.id,tmName:a.tmName,logoUrl:a.logoUrl},d.value=!0}const n=c({tmName:"",logoUrl:""}),p=c(),S=c({tmName:[{required:!0,validator:(a,e,r)=>{e.trim().length<2?r(new Error("品牌名字至少为两个字")):r()},trigger:"blur"}],logoUrl:[{required:!0,validator:(a,e,r)=>{e==""?r(new Error("请上传品牌LOGO")):r()},trigger:"change"}]});function q(a){a&&a.validate(e=>{e?y(()=>U.product.trademark.reqAddAndUpdateTradenark(n.value),()=>{d.value=!1,u.success(n.value.id?"更新成功":"添加成功"),m()}):u.error("表单有错误，请检查。")})}const A=(a,e)=>{var r;a.data?(u.success("图片通过检查，请继续"),n.value.logoUrl=a.data,(r=p.value)==null||r.clearValidate("logoUrl")):u.error("图片未通过检查，请重新选择")},B=a=>{if(/png|jpeg/g.test(a.type)){if(a.size/1024/1024>4)return u.error("不能大于 4MB!"),!1}else return u.error("只能上传jpg格式的图片"),!1;return u.info("正在检查图片，请稍等"),!0};function E(a){y(()=>U.product.trademark.reqDelTradenark(a),()=>{var e;u.success("删除成功"),((e=k.value)==null?void 0:e.length)==1&&i.value.page--,m()})}return(a,e)=>{const r=s("el-button"),v=s("el-table-column"),F=s("el-popconfirm"),G=s("el-table"),R=s("el-pagination"),j=s("el-card"),D=s("el-input"),C=s("el-form-item"),M=s("el-icon"),K=s("el-upload"),Q=s("el-form"),H=s("el-dialog"),b=Y("my-show-button");return _(),x("div",null,[t(j,{shadow:"always","body-style":{padding:"20px"}},{default:o(()=>[f((_(),w(r,{type:"primary",icon:g(h),onClick:e[0]||(e[0]=l=>O(p.value))},{default:o(()=>[N("添加品牌")]),_:1},8,["icon"])),[[b,"btn.Trademark.add"]]),t(G,{class:"table_css",data:k.value,border:"",style:{margin:"20px 0",width:"100%"}},{default:o(()=>[t(v,{type:"index",label:"序号",align:"center",width:"100"}),t(v,{prop:"tmName",label:"品牌名字"}),t(v,{label:"品牌LOGO"},{default:o(({row:l})=>[T("img",{class:"img_css",src:l.logoUrl,alt:"显示失败",onError:z},null,40,ae)]),_:1}),t(v,{label:"品牌操作"},{default:o(({row:l})=>[f(t(r,{type:"warning",icon:g(Z),onClick:J=>P(l,p.value)},null,8,["icon","onClick"]),[[b,"btn.Trademark.update"]]),f((_(),x("span",te,[t(F,{trigger:"click",icon:g(V),title:`你确定要删除 ${l.tmName} ?`,width:250,onConfirm:J=>E(l.id)},{reference:o(()=>[t(r,{type:"danger",icon:g(V)},null,8,["icon"])]),_:2},1032,["icon","title","onConfirm"])])),[[b,"btn.Trademark.remove"]])]),_:1})]),_:1},8,["data"]),f(t(R,{total:i.value.total,currentPage:i.value.page,"onUpdate:currentPage":e[1]||(e[1]=l=>i.value.page=l),"page-size":i.value.limit,"onUpdate:pageSize":e[2]||(e[2]=l=>i.value.limit=l),"page-sizes":[3,5,7],"pager-count":7,background:"",layout:"  prev, pager, next, jumper,->, sizes, total,",onSizeChange:$,onCurrentChange:L},null,8,["total","currentPage","page-size"]),[[I,i.value.total>3]])]),_:1}),t(H,{title:n.value.id?"修改品牌":"添加品牌",modelValue:d.value,"onUpdate:modelValue":e[6]||(e[6]=l=>d.value=l),width:"800px"},{footer:o(()=>[T("span",null,[t(r,{onClick:e[4]||(e[4]=l=>d.value=!1)},{default:o(()=>[N("取消")]),_:1}),t(r,{type:"primary",onClick:e[5]||(e[5]=l=>q(p.value))},{default:o(()=>[N("确定")]),_:1})])]),default:o(()=>[t(Q,{model:n.value,ref_key:"trademarkFormRef",ref:p,rules:S.value,"label-width":"100px",inline:!1,style:{width:"80%"}},{default:o(()=>[t(C,{label:"品牌名字",prop:"tmName"},{default:o(()=>[t(D,{modelValue:n.value.tmName,"onUpdate:modelValue":e[3]||(e[3]=l=>n.value.tmName=l)},null,8,["modelValue"])]),_:1}),t(C,{label:"品牌LOGO",prop:"logoUrl"},{default:o(()=>[t(K,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":A,"before-upload":B},{default:o(()=>[n.value.logoUrl?(_(),x("img",{key:0,src:n.value.logoUrl,class:"avatar"},null,8,le)):(_(),w(M,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[t(g(h))]),_:1}))]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});const ue=ee(oe,[["__scopeId","data-v-0a4a9eb1"]]);export{ue as default};
